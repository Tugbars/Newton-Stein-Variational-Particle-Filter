<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adaptive Methods for Stein Variational Particle Filtering in Stochastic Volatility Models</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:opsz,wght@8..60,400;8..60,600;8..60,700&family=Source+Sans+3:wght@400;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --text-primary: #1a1a1a;
            --text-secondary: #555;
            --text-muted: #777;
            --bg-primary: #fefefe;
            --bg-secondary: #f8f9fa;
            --bg-code: #f4f4f4;
            --accent-blue: #2563eb;
            --accent-green: #059669;
            --accent-red: #dc2626;
            --accent-purple: #7c3aed;
            --accent-orange: #d97706;
            --border: #e5e7eb;
            --border-dark: #d1d5db;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Serif 4', Georgia, serif;
            font-size: 11pt;
            line-height: 1.6;
            color: var(--text-primary);
            background: var(--bg-primary);
            max-width: 850px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        /* Typography */
        h1, h2, h3, h4 {
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 600;
            color: var(--text-primary);
        }

        h1 {
            font-size: 1.8rem;
            text-align: center;
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .authors {
            text-align: center;
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
        }

        .affiliation {
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 1.5rem;
        }

        .abstract {
            background: var(--bg-secondary);
            border-left: 4px solid var(--accent-blue);
            padding: 1rem 1.25rem;
            margin: 1.5rem 0;
            font-size: 0.95rem;
        }

        .abstract-title {
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
            color: var(--accent-blue);
        }

        h2 {
            font-size: 1.25rem;
            margin: 2rem 0 1rem;
            padding-bottom: 0.25rem;
            border-bottom: 1px solid var(--border);
        }

        h2 .section-number {
            color: var(--accent-blue);
            margin-right: 0.5rem;
        }

        h3 {
            font-size: 1.05rem;
            margin: 1.5rem 0 0.75rem;
            color: var(--text-secondary);
        }

        p {
            margin-bottom: 1rem;
            text-align: justify;
            hyphens: auto;
        }

        /* Math and formulas */
        .equation {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
            font-family: 'Source Serif 4', Georgia, serif;
            font-style: italic;
            overflow-x: auto;
        }

        .equation-number {
            float: right;
            color: var(--text-muted);
            font-style: normal;
        }

        .inline-math {
            font-family: 'Source Serif 4', Georgia, serif;
            font-style: italic;
            white-space: nowrap;
        }

        /* Code */
        code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85em;
            background: var(--bg-code);
            padding: 0.15rem 0.35rem;
            border-radius: 3px;
        }

        pre {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            background: var(--bg-code);
            border: 1px solid var(--border);
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
            line-height: 1.5;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        th, td {
            padding: 0.5rem 0.75rem;
            text-align: left;
            border: 1px solid var(--border);
        }

        th {
            background: var(--bg-secondary);
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 600;
        }

        caption {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-align: left;
        }

        /* Figures */
        figure {
            margin: 1.5rem 0;
            text-align: center;
        }

        figcaption {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 0.75rem;
            text-align: left;
        }

        figcaption strong {
            color: var(--text-primary);
        }

        /* Visualization containers */
        .viz-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .viz-title {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
            text-align: center;
        }

        /* SVG diagrams */
        svg {
            max-width: 100%;
            height: auto;
        }

        /* Theorem/Definition boxes */
        .theorem-box {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-left: 4px solid var(--accent-blue);
            padding: 1rem;
            margin: 1rem 0;
        }

        .theorem-title {
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--accent-blue);
            margin-bottom: 0.5rem;
        }

        .insight-box {
            background: #faf5ff;
            border: 1px solid #e9d5ff;
            border-left: 4px solid var(--accent-purple);
            padding: 1rem;
            margin: 1rem 0;
        }

        .insight-title {
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--accent-purple);
            margin-bottom: 0.5rem;
        }

        .result-box {
            background: #ecfdf5;
            border: 1px solid #a7f3d0;
            border-left: 4px solid var(--accent-green);
            padding: 1rem;
            margin: 1rem 0;
        }

        .result-title {
            font-family: 'Source Sans 3', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--accent-green);
            margin-bottom: 0.5rem;
        }

        /* Improvement indicators */
        .improvement-positive { color: var(--accent-green); font-weight: 600; }
        .improvement-negative { color: var(--accent-red); font-weight: 600; }

        /* Side-by-side comparison */
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }

        @media (max-width: 600px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }

        .comparison-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 1rem;
            border-radius: 4px;
        }

        .comparison-label {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        /* References */
        .references {
            font-size: 0.9rem;
        }

        .references ol {
            padding-left: 1.5rem;
        }

        .references li {
            margin-bottom: 0.5rem;
        }

        /* Summary stats */
        .summary-stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            flex-wrap: wrap;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 4px;
            margin: 1rem 0;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-family: 'Source Sans 3', sans-serif;
            font-size: 1.75rem;
            font-weight: 700;
        }

        .stat-value.baseline { color: var(--accent-red); }
        .stat-value.final { color: var(--accent-green); }
        .stat-value.delta { color: var(--accent-blue); }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Footer */
        footer {
            margin-top: 3rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
            font-size: 0.85rem;
            color: var(--text-muted);
            text-align: center;
        }

        /* Print styles */
        @media print {
            body {
                font-size: 10pt;
                max-width: none;
            }
            
            .viz-container {
                break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <!-- Title -->
    <header>
        <h1>Adaptive Methods for Stein Variational Particle Filtering in Stochastic Volatility Models</h1>
        <p class="authors">Technical Report</p>
        <p class="affiliation">January 2026</p>
    </header>

    <!-- Abstract -->
    <div class="abstract">
        <div class="abstract-title">Abstract</div>
        <p style="margin-bottom: 0;">
            We present a systematic study of adaptive methods for Stein Variational Particle Filtering (SVPF) 
            applied to stochastic volatility estimation. Starting from a baseline implementation, we identify 
            and correct fundamental issues in the gradient computation, then introduce six principled 
            enhancements that collectively reduce RMSE by 20.3% (from 0.691 to 0.551). Each enhancement 
            exploits a specific structural property of the problem: the gradient serves as a direct 
            communication channel to particles, allowing adaptive parameters to immediately influence 
            particle trajectories. We provide theoretical justification, implementation details, and 
            empirical validation across six benchmark scenarios. The key insight is that SVPF's 
            deterministic transport—unlike resampling-based filters—enables real-time adaptation 
            through gradient modulation.
        </p>
    </div>

    <!-- Summary Statistics -->
    <div class="summary-stats">
        <div class="stat-item">
            <div class="stat-value baseline">0.691</div>
            <div class="stat-label">Baseline RMSE</div>
        </div>
        <div class="stat-item">
            <div class="stat-value final">0.551</div>
            <div class="stat-label">Final RMSE</div>
        </div>
        <div class="stat-item">
            <div class="stat-value delta">−20.3%</div>
            <div class="stat-label">Improvement</div>
        </div>
    </div>

    <!-- Section 1: Introduction -->
    <h2><span class="section-number">1</span>Introduction</h2>
    
    <p>
        Stochastic volatility (SV) models are fundamental in quantitative finance, capturing the 
        time-varying nature of asset return volatility. The canonical model expresses log-volatility 
        <span class="inline-math">h<sub>t</sub></span> as an autoregressive process:
    </p>

    <div class="equation">
        h<sub>t</sub> = μ + ρ(h<sub>t−1</sub> − μ) + σ<sub>z</sub>ε<sub>t</sub>, 
        &nbsp;&nbsp;&nbsp;
        y<sub>t</sub> = exp(h<sub>t</sub>/2) · η<sub>t</sub>
        <span class="equation-number">(1)</span>
    </div>

    <p>
        where <span class="inline-math">μ</span> is the mean log-volatility level, 
        <span class="inline-math">ρ ∈ (0,1)</span> is the persistence parameter, 
        <span class="inline-math">σ<sub>z</sub></span> is the volatility-of-volatility, and 
        <span class="inline-math">η<sub>t</sub></span> follows a heavy-tailed distribution (typically Student-t).
    </p>

    <p>
        Stein Variational Particle Filtering (SVPF) offers a compelling alternative to traditional 
        bootstrap particle filters. Rather than using importance sampling and resampling—which 
        causes sample impoverishment—SVPF transports particles along the Stein variational gradient:
    </p>

    <div class="equation">
        φ(x) = (1/N) Σ<sub>j</sub> [ K(x, x<sub>j</sub>) · ∇log p(x<sub>j</sub>) + ∇<sub>x</sub>K(x, x<sub>j</sub>) ]
        <span class="equation-number">(2)</span>
    </div>

    <p>
        This deterministic transport has a crucial property: <strong>the gradient directly controls 
        particle movement</strong>. Unlike bootstrap filters where parameter changes only affect 
        proposal distributions probabilistically, in SVPF, modifying the gradient immediately 
        tells particles where to go.
    </p>

    <div class="insight-box">
        <div class="insight-title">Central Insight</div>
        <p style="margin-bottom: 0;">
            The gradient is a <em>communication channel</em> to particles. Every adaptive parameter 
            modulates this channel: increasing <span class="inline-math">σ<sub>z</sub></span> weakens 
            the prior gradient (particles spread), shifting <span class="inline-math">μ</span> 
            redirects the prior mean (particles drift), and adjusting the likelihood offset 
            corrects systematic bias (particles center correctly).
        </p>
    </div>

    <!-- Figure: Gradient Modulation Diagram -->
    <figure>
        <div class="viz-container">
            <div class="viz-title">The Gradient as a Communication Channel</div>
            <svg viewBox="0 0 650 300" style="width: 100%; max-width: 650px;">
                <!-- Central gradient field box -->
                <rect x="225" y="110" width="200" height="80" rx="8" fill="#eff6ff" stroke="#2563eb" stroke-width="2"/>
                <text x="325" y="140" text-anchor="middle" font-family="Source Sans 3" font-weight="600" font-size="13" fill="#1e40af">Gradient Field</text>
                <text x="325" y="158" text-anchor="middle" font-family="Source Serif 4" font-style="italic" font-size="12" fill="#3b82f6">∇ log p(x)</text>
                <text x="325" y="178" text-anchor="middle" font-family="Source Sans 3" font-size="10" fill="#64748b">"Tells particles where to go"</text>
                
                <!-- Input parameters - left side -->
                <rect x="30" y="30" width="120" height="45" rx="4" fill="#dcfce7" stroke="#059669"/>
                <text x="90" y="52" text-anchor="middle" font-family="Source Sans 3" font-weight="600" font-size="10" fill="#047857">Adaptive μ</text>
                <text x="90" y="66" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#059669">Shifts prior mean</text>
                <path d="M 150 52 L 225 130" stroke="#059669" stroke-width="1.5" fill="none" marker-end="url(#arrowGreen)"/>
                
                <rect x="30" y="100" width="120" height="45" rx="4" fill="#fef3c7" stroke="#d97706"/>
                <text x="90" y="122" text-anchor="middle" font-family="Source Sans 3" font-weight="600" font-size="10" fill="#b45309">Adaptive σ<tspan baseline-shift="sub" font-size="7">z</tspan></text>
                <text x="90" y="136" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#d97706">Prior strength</text>
                <path d="M 150 122 L 225 145" stroke="#d97706" stroke-width="1.5" fill="none" marker-end="url(#arrowOrange)"/>
                
                <rect x="30" y="170" width="120" height="45" rx="4" fill="#fce7f3" stroke="#be185d"/>
                <text x="90" y="192" text-anchor="middle" font-family="Source Sans 3" font-weight="600" font-size="10" fill="#9d174d">lik_offset</text>
                <text x="90" y="206" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#be185d">Gradient direction</text>
                <path d="M 150 192 L 225 165" stroke="#be185d" stroke-width="1.5" fill="none" marker-end="url(#arrowPink)"/>
                
                <!-- Input parameters - right side -->
                <rect x="500" y="30" width="120" height="45" rx="4" fill="#e0e7ff" stroke="#4f46e5"/>
                <text x="560" y="52" text-anchor="middle" font-family="Source Sans 3" font-weight="600" font-size="10" fill="#3730a3">Guide Strength</text>
                <text x="560" y="66" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#4f46e5">Observation pull</text>
                <path d="M 500 52 L 425 130" stroke="#4f46e5" stroke-width="1.5" fill="none" marker-end="url(#arrowIndigo)"/>
                
                <rect x="500" y="100" width="120" height="45" rx="4" fill="#f3e8ff" stroke="#7c3aed"/>
                <text x="560" y="122" text-anchor="middle" font-family="Source Sans 3" font-weight="600" font-size="10" fill="#5b21b6">ν (nu)</text>
                <text x="560" y="136" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#7c3aed">Shock sensitivity</text>
                <path d="M 500 122 L 425 145" stroke="#7c3aed" stroke-width="1.5" fill="none" marker-end="url(#arrowPurple)"/>
                
                <rect x="500" y="170" width="120" height="45" rx="4" fill="#ccfbf1" stroke="#0d9488"/>
                <text x="560" y="192" text-anchor="middle" font-family="Source Sans 3" font-weight="600" font-size="10" fill="#0f766e">IMQ Kernel</text>
                <text x="560" y="206" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#0d9488">Repulsion range</text>
                <path d="M 500 192 L 425 165" stroke="#0d9488" stroke-width="1.5" fill="none" marker-end="url(#arrowTeal)"/>
                
                <!-- Output: particles -->
                <text x="325" y="215" text-anchor="middle" font-size="16" fill="#64748b">↓</text>
                
                <!-- Particle cloud -->
                <circle cx="290" cy="260" r="6" fill="#3b82f6" opacity="0.8"/>
                <circle cx="310" cy="255" r="6" fill="#3b82f6" opacity="0.8"/>
                <circle cx="330" cy="262" r="6" fill="#3b82f6" opacity="0.8"/>
                <circle cx="350" cy="258" r="6" fill="#3b82f6" opacity="0.8"/>
                <circle cx="320" cy="270" r="6" fill="#3b82f6" opacity="0.8"/>
                
                <text x="325" y="295" text-anchor="middle" font-family="Source Sans 3" font-size="10" fill="#64748b">Particles follow the gradient</text>
                
                <!-- Arrow markers -->
                <defs>
                    <marker id="arrowGreen" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#059669"/>
                    </marker>
                    <marker id="arrowOrange" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#d97706"/>
                    </marker>
                    <marker id="arrowPink" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#be185d"/>
                    </marker>
                    <marker id="arrowIndigo" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#4f46e5"/>
                    </marker>
                    <marker id="arrowPurple" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#7c3aed"/>
                    </marker>
                    <marker id="arrowTeal" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                        <polygon points="0 0, 8 3, 0 6" fill="#0d9488"/>
                    </marker>
                </defs>
            </svg>
        </div>
        <figcaption>
            <strong>Figure 1:</strong> Each adaptive parameter modulates the gradient field that guides 
            particle transport. Unlike bootstrap filters where adaptation is probabilistic, SVPF provides 
            a direct communication channel to the particle ensemble.
        </figcaption>
    </figure>

    <!-- Section 2: Adaptive Methods -->
    <h2><span class="section-number">2</span>Adaptive Methods</h2>

    <p>
        We present six adaptive methods in order of empirical impact. Each addresses a specific 
        limitation of the baseline filter and exploits the gradient-as-communication-channel principle.
    </p>

    <!-- 2.1 Adaptive Mu -->
    <h3>2.1 Adaptive Mean Level (−10.0%)</h3>

    <p>
        The SV model assumes a fixed mean level <span class="inline-math">μ</span> for log-volatility, 
        but real markets exhibit regime-dependent means. During stress periods, 
        <span class="inline-math">μ</span> may shift from −3.5 (calm) to −1.5 (crisis). A fixed 
        <span class="inline-math">μ</span> causes persistent tracking bias.
    </p>

    <figure>
        <div class="viz-container">
            <div class="viz-title">Effect of Adaptive μ on Particle Cloud</div>
            <svg viewBox="0 0 600 200" style="width: 100%; max-width: 600px;">
                <!-- Background regions -->
                <rect x="50" y="30" width="200" height="140" fill="#fef2f2" stroke="#fca5a5" rx="4"/>
                <rect x="350" y="30" width="200" height="140" fill="#f0fdf4" stroke="#86efac" rx="4"/>
                
                <!-- Labels -->
                <text x="150" y="22" text-anchor="middle" font-family="Source Sans 3" font-size="11" fill="#666">Fixed μ = −3.5</text>
                <text x="450" y="22" text-anchor="middle" font-family="Source Sans 3" font-size="11" fill="#666">Adaptive μ</text>
                
                <!-- True trajectory (dashed) -->
                <path d="M 70 140 Q 150 60, 230 80" stroke="#dc2626" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
                <path d="M 370 140 Q 450 60, 530 80" stroke="#059669" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
                
                <!-- Fixed mu: particles lag behind -->
                <circle cx="90" cy="130" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="100" cy="125" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="95" cy="135" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="130" cy="115" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="140" cy="120" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="135" cy="110" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="180" cy="100" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="190" cy="105" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="185" cy="95" r="4" fill="#3b82f6" opacity="0.7"/>
                
                <!-- Gap indicator -->
                <line x1="200" y1="70" x2="200" y2="100" stroke="#dc2626" stroke-width="2"/>
                <text x="215" y="88" font-family="Source Sans 3" font-size="9" fill="#dc2626">bias</text>
                
                <!-- Adaptive mu: particles track -->
                <circle cx="390" cy="130" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="400" cy="125" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="395" cy="135" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="440" cy="85" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="450" cy="80" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="445" cy="90" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="500" cy="75" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="510" cy="80" r="4" fill="#3b82f6" opacity="0.7"/>
                <circle cx="505" cy="85" r="4" fill="#3b82f6" opacity="0.7"/>
                
                <!-- μ shift arrow -->
                <path d="M 420 150 L 420 100" stroke="#059669" stroke-width="2" marker-end="url(#arrowGreen)"/>
                <text x="430" y="130" font-family="Source Sans 3" font-size="9" fill="#059669">μ adapts</text>
            </svg>
        </div>
        <figcaption>
            <strong>Figure 2:</strong> With fixed <span class="inline-math">μ</span> (left), particles 
            cluster around the wrong mean level during regime shifts, creating persistent bias. 
            Adaptive <span class="inline-math">μ</span> (right) tracks the shifting mean.
        </figcaption>
    </figure>

    <p>
        We implement a 1D Kalman filter on <span class="inline-math">μ</span> using the particle 
        posterior mean <span class="inline-math">h̄</span> as the observation. The key innovation 
        is <strong>confidence gating</strong>: when particles are spread (high bandwidth), 
        we increase observation noise <span class="inline-math">R</span> to slow adaptation:
    </p>

    <div class="equation">
        R = α · bandwidth², &nbsp;&nbsp;&nbsp; 
        K = P / (P + R), &nbsp;&nbsp;&nbsp; 
        μ ← μ + K · (h̄ − μ)
        <span class="equation-number">(3)</span>
    </div>

    <div class="theorem-box">
        <div class="theorem-title">Confidence Gating Principle</div>
        <p style="margin-bottom: 0;">
            <strong>Calm market</strong> (low bandwidth): High confidence → fast adaptation<br>
            <strong>Crisis</strong> (high bandwidth): Low confidence → freeze μ to avoid noise
        </p>
    </div>

    <!-- 2.2 Likelihood Offset -->
    <h3>2.2 Likelihood Offset Correction (−7.4%)</h3>

    <p>
        The likelihood gradient provides the "observation pull" that centers particles around the 
        true volatility. For the log-squared observation model:
    </p>

    <div class="equation">
        ∇<sub>h</sub> log p(y|h) ∝ (log y² − h + offset) / R
        <span class="equation-number">(4)</span>
    </div>

    <p>
        The offset compensates for <span class="inline-math">E[log η²]</span>. The original 
        implementation used <span class="inline-math">1/ν ≈ 0.2</span>, which was 
        <strong>0.5 units too low</strong>, causing systematic underestimation.
    </p>

    <figure>
        <div class="viz-container">
            <div class="viz-title">Gradient Direction vs. Likelihood Offset</div>
            <svg viewBox="0 0 500 180" style="width: 100%; max-width: 500px;">
                <!-- Axes -->
                <line x1="50" y1="90" x2="450" y2="90" stroke="#e5e7eb" stroke-width="1"/>
                <line x1="250" y1="30" x2="250" y2="150" stroke="#e5e7eb" stroke-width="1"/>
                
                <!-- Labels -->
                <text x="250" y="170" text-anchor="middle" font-family="Source Sans 3" font-size="10" fill="#666">h − h_true</text>
                
                <!-- Wrong offset: biased gradient -->
                <line x1="100" y1="60" x2="400" y2="120" stroke="#dc2626" stroke-width="2"/>
                <text x="380" y="140" font-family="Source Sans 3" font-size="9" fill="#dc2626">offset = 0.2 (biased)</text>
                
                <!-- Correct offset: centered gradient -->
                <line x1="100" y1="120" x2="400" y2="60" stroke="#059669" stroke-width="2"/>
                <text x="380" y="50" font-family="Source Sans 3" font-size="9" fill="#059669">offset = 0.7 (correct)</text>
                
                <!-- Zero crossing markers -->
                <circle cx="170" cy="90" r="4" fill="#dc2626"/>
                <circle cx="250" cy="90" r="4" fill="#059669"/>
                
                <!-- Bias annotation -->
                <line x1="170" y1="95" x2="250" y2="95" stroke="#7c3aed" stroke-width="1" stroke-dasharray="3,2"/>
                <text x="210" y="110" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#7c3aed">systematic bias</text>
            </svg>
        </div>
        <figcaption>
            <strong>Figure 3:</strong> The likelihood gradient crosses zero at 
            <span class="inline-math">h = log y² + offset</span>. A wrong offset shifts the 
            zero-crossing, causing particles to systematically converge to the wrong value.
        </figcaption>
    </figure>

    <table>
        <caption><strong>Table 1:</strong> Offset Calibration</caption>
        <thead>
            <tr><th>Offset</th><th>Resulting Bias</th><th>RMSE</th></tr>
        </thead>
        <tbody>
            <tr><td>0.20 (1/ν)</td><td>−0.30</td><td>0.607</td></tr>
            <tr style="background: #ecfdf5;"><td><strong>0.70</strong></td><td><strong>~0.00</strong></td><td><strong>0.563</strong></td></tr>
            <tr><td>1.27 (Gaussian)</td><td>+0.30</td><td>0.610</td></tr>
        </tbody>
    </table>

    <!-- 2.3 IMQ Kernel -->
    <h3>2.3 Inverse Multiquadric Kernel (−0.6%)</h3>

    <p>
        The standard Gaussian RBF kernel has <em>exponential</em> decay. When a particle explores 
        a distant region during a volatility spike, the kernel value drops to near-zero, 
        effectively <strong>stranding</strong> the particle.
    </p>

    <p>
        The Inverse Multiquadric (IMQ) kernel has <em>polynomial</em> decay:
    </p>

    <div class="equation">
        K<sub>IMQ</sub>(x, x') = (1 + ‖x − x'‖² / h²)<sup>−1</sup>
        <span class="equation-number">(5)</span>
    </div>

    <figure>
        <div class="viz-container">
            <div class="viz-title">Kernel Decay: Gaussian RBF vs IMQ</div>
            <div style="display: flex; gap: 2rem; justify-content: center; align-items: flex-end; height: 140px; padding: 1rem;">
                <div style="text-align: center;">
                    <div style="display: flex; gap: 8px; align-items: flex-end; height: 100px;">
                        <div style="width: 25px; height: 95px; background: linear-gradient(to top, #3b82f6, #93c5fd); border-radius: 2px 2px 0 0;"></div>
                        <div style="width: 25px; height: 70px; background: linear-gradient(to top, #3b82f6, #93c5fd); border-radius: 2px 2px 0 0;"></div>
                        <div style="width: 25px; height: 20px; background: linear-gradient(to top, #3b82f6, #93c5fd); border-radius: 2px 2px 0 0;"></div>
                        <div style="width: 25px; height: 3px; background: linear-gradient(to top, #dc2626, #fca5a5); border-radius: 2px 2px 0 0;"></div>
                        <div style="width: 25px; height: 1px; background: #dc2626;"></div>
                    </div>
                    <div style="font-size: 0.7rem; color: #666; margin-top: 0.5rem;">1σ &nbsp; 2σ &nbsp; 3σ &nbsp; 4σ &nbsp; 5σ</div>
                    <div style="font-size: 0.75rem; color: #dc2626; font-weight: 600; margin-top: 0.25rem;">Gaussian RBF</div>
                </div>
                <div style="text-align: center;">
                    <div style="display: flex; gap: 8px; align-items: flex-end; height: 100px;">
                        <div style="width: 25px; height: 95px; background: linear-gradient(to top, #059669, #6ee7b7); border-radius: 2px 2px 0 0;"></div>
                        <div style="width: 25px; height: 70px; background: linear-gradient(to top, #059669, #6ee7b7); border-radius: 2px 2px 0 0;"></div>
                        <div style="width: 25px; height: 40px; background: linear-gradient(to top, #059669, #6ee7b7); border-radius: 2px 2px 0 0;"></div>
                        <div style="width: 25px; height: 22px; background: linear-gradient(to top, #059669, #6ee7b7); border-radius: 2px 2px 0 0;"></div>
                        <div style="width: 25px; height: 12px; background: linear-gradient(to top, #059669, #6ee7b7); border-radius: 2px 2px 0 0;"></div>
                    </div>
                    <div style="font-size: 0.7rem; color: #666; margin-top: 0.5rem;">1σ &nbsp; 2σ &nbsp; 3σ &nbsp; 4σ &nbsp; 5σ</div>
                    <div style="font-size: 0.75rem; color: #059669; font-weight: 600; margin-top: 0.25rem;">IMQ (polynomial)</div>
                </div>
            </div>
        </div>
        <figcaption>
            <strong>Figure 4:</strong> Kernel value at various inter-particle distances. At 3σ, 
            IMQ provides <strong>10× more repulsion</strong> than Gaussian, keeping distant 
            particles connected to the group.
        </figcaption>
    </figure>

    <!-- 2.4 Newton-Stein -->
    <h3>2.4 Newton-Stein: Hessian Preconditioning</h3>

    <p>
        Standard SVGD moves particles along <span class="inline-math">∇log p</span>. Newton-Stein 
        preconditions by the inverse Hessian, adapting step size to local curvature:
    </p>

    <div class="equation">
        φ<sub>Newton</sub>(x) = (1/N) Σ<sub>j</sub> [ K(x, x<sub>j</sub>) · H<sub>j</sub><sup>−1</sup> · ∇log p(x<sub>j</sub>) ]
        <span class="equation-number">(6)</span>
    </div>

    <p>
        Following Detommaso et al. (2018), we implement two variants:
    </p>

    <div class="comparison-grid">
        <div class="comparison-item">
            <div class="comparison-label" style="color: var(--accent-blue);">Approximate Newton</div>
            <p style="font-size: 0.9rem; margin: 0;">
                Uses <strong>local</strong> Hessian H(x<sub>j</sub>) for each particle. Fast, works 
                well when particles are in similar curvature regions.
            </p>
        </div>
        <div class="comparison-item">
            <div class="comparison-label" style="color: var(--accent-purple);">Full Newton</div>
            <p style="font-size: 0.9rem; margin: 0;">
                Uses <strong>kernel-weighted average</strong> of Hessians. Smooths the landscape; 
                better when particles span different curvature regions.
            </p>
        </div>
    </div>

    <table>
        <caption><strong>Table 2:</strong> Newton-Stein Performance</caption>
        <thead>
            <tr><th>Condition</th><th>Approximate</th><th>Full</th><th>Δ</th><th>Latency</th></tr>
        </thead>
        <tbody>
            <tr><td>Good priors</td><td>0.5521</td><td>0.5514</td><td>−0.1%</td><td>+15%</td></tr>
            <tr><td><strong>Bad priors</strong></td><td>0.6396</td><td><strong>0.6322</strong></td><td class="improvement-positive">−1.2%</td><td>+15%</td></tr>
        </tbody>
    </table>

    <div class="insight-box">
        <div class="insight-title">Recommendation</div>
        <p style="margin-bottom: 0;">
            Use approximate Newton (default) for production. Enable full Newton during cold-start 
            or when prior uncertainty is high—the kernel-weighted Hessian helps particles coordinate 
            when they're spread across different curvature regions.
        </p>
    </div>

    <!-- Section 3: Results -->
    <h2><span class="section-number">3</span>Cumulative Results</h2>

    <table>
        <caption><strong>Table 3:</strong> Optimization Journey</caption>
        <thead>
            <tr><th>Method</th><th>RMSE</th><th>Δ from Prev</th><th>Cumulative Δ</th></tr>
        </thead>
        <tbody>
            <tr><td>Baseline (fixed params)</td><td>0.691</td><td>—</td><td>—</td></tr>
            <tr><td>+ Adaptive μ</td><td>0.622</td><td class="improvement-positive">−10.0%</td><td>−10.0%</td></tr>
            <tr><td>+ Adaptive Guide</td><td>0.607</td><td class="improvement-positive">−2.3%</td><td>−12.1%</td></tr>
            <tr><td>+ Likelihood Offset</td><td>0.563</td><td class="improvement-positive">−7.4%</td><td>−18.6%</td></tr>
            <tr><td>+ ν=30 + Adaptive σ<sub>z</sub></td><td>0.554</td><td class="improvement-positive">−1.5%</td><td>−19.9%</td></tr>
            <tr style="background: #f0fdf4;"><td><strong>+ IMQ Kernel</strong></td><td><strong>0.551</strong></td><td class="improvement-positive">−0.6%</td><td class="improvement-positive"><strong>−20.3%</strong></td></tr>
        </tbody>
    </table>

    <figure>
        <div class="viz-container">
            <div class="viz-title">RMSE Trajectory</div>
            <svg viewBox="0 0 600 180" style="width: 100%; max-width: 600px;">
                <!-- Grid -->
                <line x1="80" y1="30" x2="80" y2="140" stroke="#e5e7eb" stroke-width="1"/>
                <line x1="80" y1="140" x2="560" y2="140" stroke="#e5e7eb" stroke-width="1"/>
                
                <!-- Y-axis labels -->
                <text x="70" y="35" text-anchor="end" font-family="Source Sans 3" font-size="9" fill="#666">0.70</text>
                <text x="70" y="85" text-anchor="end" font-family="Source Sans 3" font-size="9" fill="#666">0.60</text>
                <text x="70" y="135" text-anchor="end" font-family="Source Sans 3" font-size="9" fill="#666">0.55</text>
                
                <!-- Progress line -->
                <polyline points="100,32 180,62 260,72 340,108 420,118 500,125" 
                          fill="none" stroke="#3b82f6" stroke-width="3"/>
                
                <!-- Data points -->
                <circle cx="100" cy="32" r="6" fill="#dc2626"/>
                <circle cx="180" cy="62" r="6" fill="#3b82f6"/>
                <circle cx="260" cy="72" r="6" fill="#3b82f6"/>
                <circle cx="340" cy="108" r="6" fill="#3b82f6"/>
                <circle cx="420" cy="118" r="6" fill="#3b82f6"/>
                <circle cx="500" cy="125" r="6" fill="#059669"/>
                
                <!-- Labels -->
                <text x="100" y="22" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#666">Baseline</text>
                <text x="180" y="52" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#666">+μ</text>
                <text x="260" y="62" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#666">+Guide</text>
                <text x="340" y="98" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#666">+Offset</text>
                <text x="420" y="108" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#666">+ν,σ</text>
                <text x="500" y="145" text-anchor="middle" font-family="Source Sans 3" font-size="8" fill="#059669">+IMQ</text>
                <text x="530" y="125" font-family="Source Sans 3" font-size="10" fill="#059669" font-weight="600">0.551</text>
            </svg>
        </div>
        <figcaption>
            <strong>Figure 5:</strong> RMSE trajectory across optimization stages. The largest 
            gains came from adaptive μ (−10%) and likelihood offset correction (−7.4%).
        </figcaption>
    </figure>

    <!-- Section 4: Conclusion -->
    <h2><span class="section-number">4</span>Conclusion</h2>

    <p>
        We presented six adaptive methods for SVPF achieving a 20.3% RMSE reduction. The key insight 
        is that SVPF's deterministic transport makes it uniquely suited for adaptive methods: 
        changing parameters directly modulates the gradient, immediately telling particles where to go.
    </p>

    <table>
        <caption><strong>Table 4:</strong> Gradient Modulation Summary</caption>
        <thead>
            <tr><th>Parameter Change</th><th>Gradient Effect</th><th>Particle Response</th></tr>
        </thead>
        <tbody>
            <tr><td>↑ σ<sub>z</sub></td><td>Prior weakens</td><td>Spread out, explore</td></tr>
            <tr><td>Shift μ</td><td>Prior mean shifts</td><td>Drift toward new μ</td></tr>
            <tr><td>Fix lik_offset</td><td>Correct gradient direction</td><td>Unbiased convergence</td></tr>
            <tr><td>↑ guide_strength</td><td>Likelihood pull ↑</td><td>Snap to observation</td></tr>
            <tr><td>IMQ kernel</td><td>Polynomial repulsion</td><td>Stay connected at distance</td></tr>
        </tbody>
    </table>

    <div class="result-box">
        <div class="result-title">Final Performance</div>
        <p style="margin-bottom: 0;">
            <strong>RMSE:</strong> 0.551 &nbsp;|&nbsp; 
            <strong>Bias:</strong> ~0 &nbsp;|&nbsp; 
            <strong>Improvement:</strong> −20.3% from baseline
        </p>
    </div>

    <!-- References -->
    <h2>References</h2>
    <div class="references">
        <ol>
            <li>Liu, Q. & Wang, D. (2016). Stein Variational Gradient Descent. <em>NeurIPS</em>.</li>
            <li>Detommaso, G. et al. (2018). A Stein Variational Newton Method. <em>NeurIPS</em>.</li>
            <li>Fan, Y. et al. (2021). Stein Particle Filtering. <em>arXiv:2106.10568</em>.</li>
        </ol>
    </div>

    <footer>
        <p>SVPF Adaptive Methods Technical Report • January 2026</p>
    </footer>
</body>
</html>
